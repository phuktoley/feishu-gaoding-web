# 飞书-稿定设计批量套版工具 使用手册

## 简介

本工具用于从飞书多维表格导出数据，生成符合稿定设计批量套版格式的 ZIP 文件，实现批量生成设计图的工作流。

## 功能概述

1. **飞书数据获取**: 从飞书多维表格获取数据
2. **稿定格式导出**: 将数据导出为稿定设计批量套版所需的 ZIP 格式
3. **图片处理**: 自动下载并打包图片资源
4. **批量生成**: 在稿定设计中批量生成设计图
5. **结果保存**: 将生成的图片保存回飞书

## 使用流程

### 第一步：准备飞书多维表格

1. 在飞书中创建多维表格
2. 设置好需要的字段（文本、图片等）
3. 填入数据

### 第二步：导出稿定格式

1. 访问应用的导出页面
2. 选择要导出的飞书多维表格
3. 点击"导出稿定格式"按钮
4. 等待 ZIP 文件下载完成

### 第三步：在稿定设计中使用

1. 登录稿定设计 (https://www.gaoding.com)
2. 选择或创建一个设计模板
3. 点击"文件" → "批量套版"
4. 在批量套版界面，点击"批量导入内容"
5. 点击"导入"按钮，选择下载的 ZIP 文件
6. 确认数据映射关系
7. 点击"开始生成"

### 第四步：保存生成的图片

1. 在稿定设计中下载生成的图片
2. 将图片上传回飞书多维表格（可选）

## ZIP 文件结构

导出的 ZIP 文件包含以下内容：

```
稿定设计-数据上传_YYYY-MM-DD.zip
├── 稿定设计-数据上传.xlsx    # 数据表格
└── images/                    # 图片文件夹
    ├── image1.jpg
    ├── image2.jpg
    └── ...
```

### XLSX 文件格式

- 第一行为表头（字段名称）
- 后续行为数据
- 图片字段使用相对路径 `images/xxx.jpg`

## 稿定设计模板要求

### 标注可编辑元素

在稿定设计中使用批量套版功能前，需要先标注模板中的可编辑元素：

1. 打开设计模板
2. 选中需要批量替换的文本或图片元素
3. 右键点击，选择"标注为可编辑"
4. 为每个元素设置唯一的标签名称
5. 保存模板

### 数据映射

导入 ZIP 文件后，稿定设计会自动匹配：
- XLSX 表头名称 → 模板中的标签名称
- 确保两者名称一致，以便正确映射数据

## 常见问题

### Q: 导出的 ZIP 文件无法上传到稿定设计？

A: 请确保：
1. ZIP 文件未损坏
2. XLSX 文件格式正确（使用共享字符串格式）
3. 图片文件存在且路径正确

### Q: 图片无法正确显示？

A: 请检查：
1. 图片 URL 是否有效
2. 图片格式是否支持（JPG、PNG）
3. 图片文件大小是否过大

### Q: 数据无法正确映射到模板？

A: 请确保：
1. XLSX 表头名称与模板标签名称一致
2. 模板中的元素已正确标注
3. 数据类型匹配（文本对文本，图片对图片）

## 技术支持

如遇到问题，请：
1. 检查浏览器控制台是否有错误信息
2. 确认网络连接正常
3. 尝试刷新页面重新操作

## 更新日志

### v4.1 (2026-01-04)
- 修复稿定设计 XLSX 格式兼容性问题
- 使用 sharedStrings.xml 共享字符串表
- 优化图片下载和打包逻辑
